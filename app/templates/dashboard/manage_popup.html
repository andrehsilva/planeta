{% extends "dashboard/dashboard_base.html" %}
{% from "macros/_form_helpers.html" import render_field %}

{% block dashboard_content %}
<h1 class="text-3xl font-bold text-gray-800 mb-6">{{ title }}</h1>

<div class="bg-white p-8 rounded-lg shadow-md max-w-2xl mx-auto">
    <form method="POST" enctype="multipart/form-data" novalidate>
        {{ form.hidden_tag() }}
        <div class="space-y-6">
            
            {{ render_field(form.title) }}
            {{ render_field(form.target_url) }}
            {{ render_field(form.display_mode) }}
            
            {% if popup and popup.image_filename %}
                <div class="mt-4">
                    <p class="block text-sm font-medium text-gray-700 mb-2">Imagem Atual:</p>
                    <!-- CÓDIGO CORRIGIDO ABAIXO -->
                    <img src="/media/{{ popup.image_filename }}" alt="Imagem atual do popup" class="max-w-xs rounded-md shadow-sm">
                    <p class="text-xs text-gray-500 mt-1">Enviar uma nova imagem irá substituir a atual.</p>
                </div>
            {% endif %}

            <div>
                <label for="{{ form.image.id }}" class="block text-sm font-medium text-gray-700">
                    {{ form.image.label.text }}
                </label>
                <div class="mt-1">
                    {{ form.image(class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none") }}
                    {% if form.image.errors %}
                        <ul class="text-sm text-red-600 mt-1">
                        {% for error in form.image.errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                        </ul>
                    {% endif %}
                </div>
            </div>

            <div class="bg-slate-50 p-4 rounded-md border border-slate-200">
                <div class="flex items-center">
                    {{ form.is_active(class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500") }}
                    <label for="{{ form.is_active.id }}" class="ml-3 block text-sm font-medium text-gray-900">
                        {{ form.is_active.label.text }}
                    </label>
                </div>
            </div>

            <div class="pt-5">
                {{ form.submit(class="w-full inline-flex justify-center py-3 px-6 border border-transparent shadow-sm text-base font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700") }}
            </div>
        </div>
    </form>
</div>
{% endblock %}

